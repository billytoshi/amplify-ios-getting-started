# buildspec.yml
version: 0.2

phases:

  install:
    commands:
      - code/ci_actions/00_install_rosetta.sh

  pre_build:
    commands:
      - code/ci_actions/01_keychain.sh
      - code/ci_actions/02_amplify.sh

  build:
    commands:
      - code/ci_actions/03_build.sh
      - # code/ci_actions/04_local_tests.sh

  post_build:
    commands:
      # - code/ci_actions/06_deploy_testflight.sh
      - code/ci_actions/07_cleanup.sh
      - mv "code/build-release/getting started.ipa" "code/build-release/getting-started.ipa"
      - ls -al "code/build-release"

artifacts:
  files:
    - 'getting-started.ipa'
  base-directory: 'code/build-release'

cache:
  paths:
    - 'code/build-release'